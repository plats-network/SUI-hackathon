import{p as g,t as m,e as h,j as w}from"./address-429e7815.js";import{t as f}from"./legacy-registry-4fcefa09.js";import{r as y}from"./_md-5eb5ac83.js";import{S as u,g as b}from"./client-144d5df2.js";import{E as S}from"./keypair-becfe882.js";import"./blake2b-0b963f07.js";import"./index-ea9ea726.js";import"./bn-a0a0c8e1.js";import"./TransactionBlock-3fb0dd4a.js";import"./nacl-fast-855db264.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-54e210ce.js";import"./util-fc318f65.js";import"./hash-046412e8.js";import"./sha512-d6693c92.js";const p=27;function d(t){const e=f(t);return e.length===0?BigInt(0):BigInt(`0x${e}`)}function k(){return String(d(y(16)))}function _(t,e,o){const n=d(t.toSuiBytes()),a=n/2n**128n,r=n%2n**128n,i=g([a,r,e,BigInt(o)]),s=m(i,20),c=h(s);if(c.length!==p)throw new Error(`Length of nonce ${c} (${c.length}) is not equal to ${p}`);return c}class l extends Error{}l.prototype.name="InvalidTokenError";function v(t){return decodeURIComponent(atob(t).replace(/(.)/g,(e,o)=>{let n=o.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n}))}function E(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return v(e)}catch{return atob(e)}}function B(t,e){if(typeof t!="string")throw new l("Invalid token specified: must be a string");e||(e={});const o=e.header===!0?0:1,n=t.split(".")[o];if(typeof n!="string")throw new l(`Invalid token specified: missing part #${o+1}`);let a;try{a=E(n)}catch(r){throw new l(`Invalid token specified: invalid base64 for part #${o+1} (${r.message})`)}try{return JSON.parse(a)}catch(r){throw new l(`Invalid token specified: invalid json for part #${o+1} (${r.message})`)}}const I="https://fullnode.devnet.sui.io",U=new u({url:I});async function L(){const{epoch:t,epochDurationMs:e,epochStartTimestampMs:o}=await U.getLatestSuiSystemState();return{epoch:t,epochDurationMs:e,epochStartTimestampMs:o}}$(".Google").click(async function(){const{epoch:t,epochDurationMs:e,epochStartTimestampMs:o}=await L(),n=Number(t)+2,a=new S;console.log(a);const r=k(),i=_(a.getPublicKey(),n,r);var s=new URLSearchParams({client_id:"290554041285-g77ars54m9vc2hvugv1oekhtd54ell9p.apps.googleusercontent.com",nonce:i,redirect_uri:$('meta[name="redirect_uri"]').attr("content"),response_type:"id_token",scope:"openid"}),c="https://accounts.google.com/o/oauth2/v2/auth?"+s.toString();localStorage.setItem("urlcallback",window.location.href),window.location.href=c,console.log(c)});$(document).ready(function(){T()});async function T(){const t=window.location.hash.substring(1),o=new URLSearchParams(t).get("id_token");if(!o)return;const n=w(o,"778508701119817782538534025112866953167371");localStorage.setItem("zkLoginUserAddress",n);const r=await new u({url:b("testnet")}).getBalance({owner:n});console.log("accountBalances",r);const i=B(o);console.log(i),$.ajax({type:"POST",url:"login_google",data:{email:i.sub+"@gmail.com",name:i.sub},dataType:"dataType",success:function(s){console.log(s),window.location.href=window.location.origin+window.location.pathname},complete:function(){window.location.href=window.location.origin+window.location.pathname}})}
