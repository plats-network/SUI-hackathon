import{j as e,r as y}from"./jsx-runtime-f0a4e50a.js";import{R as w}from"./index-f0e4c749.js";import{d as k,R as T,O as C}from"./session-103011d7.js";import{a as F}from"./axios-654eef56.js";import{T as S}from"./TransactionBlock-3fb0dd4a.js";/* empty css              */import{E as I}from"./keypair-becfe882.js";import{S as M,g as R}from"./client-144d5df2.js";import"./bn-a0a0c8e1.js";import"./legacy-registry-4fcefa09.js";import"./index-ea9ea726.js";import"./nacl-fast-855db264.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index-54e210ce.js";import"./util-fc318f65.js";import"./hash-046412e8.js";import"./blake2b-0b963f07.js";import"./_md-5eb5ac83.js";import"./secp256k1-a06cb75b.js";import"./sha512-d6693c92.js";function L({onDelete:t,onInputChange:i,onFileChange:a,nftData:l,itemKey:r}){return e.jsxs("div",{className:"row mb-3 nft-ticket-div",children:[e.jsxs("div",{className:"col-4",children:[e.jsx("input",{type:"file",accept:"image/x-png, image/jpeg",style:{display:"none"},className:"image-file-react",id:`image-file-${r}`,name:"file-image-nft",onChange:a}),e.jsx("label",{htmlFor:`image-file-${r}`,children:e.jsx("img",{className:"image-label img-preview",src:l.image_file||"/imgs/no-image.png"})})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mt-20",children:e.jsx("input",{type:"text",className:"form-control nft_name",placeholder:"NFT Title",name:"nft_name",required:!0,onChange:i})}),e.jsx("div",{className:"mt-20",children:e.jsx("input",{type:"text",className:"form-control nft_symbol",placeholder:"NFT description",name:"nft_symbol",onChange:i})})]}),e.jsxs("div",{className:"col-4",children:[e.jsx("div",{className:"mt-20",children:e.jsx("input",{type:"text",className:"form-control nft_category",placeholder:"NFT Category",name:"nft_category",defaultValue:"Standard",onChange:i})}),e.jsxs("div",{className:"row mt-20",children:[e.jsx("div",{className:"col-6",children:e.jsx("input",{type:"number",className:"form-control nft_amount",name:"nft_amount",min:"1",defaultValue:"1",onChange:i})}),e.jsx("div",{className:"col-6",children:e.jsx("button",{type:"button",className:"btn btn-danger",onClick:t,children:"Delete"})})]})]})]})}function A({nftData:t}){return e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"hidden",name:"nft-ticket-name-[]",value:t.nft_name}),e.jsx("input",{type:"hidden",name:"nft-ticket-symbol-[]",value:t.nft_symbol}),e.jsx("input",{type:"hidden",name:"nft-ticket-category-[]",value:t.nft_category}),e.jsx("input",{type:"hidden",name:"nft-ticket-uri-[]",value:t.image_file}),e.jsx("input",{type:"hidden",name:"nft-ticket-res-[]",value:t.res}),e.jsx("input",{type:"hidden",name:"nft-ticket-list-[]",value:t.tickets})]})}const O=({nftData:t})=>e.jsxs("div",{className:"row mb-3",children:[e.jsx("div",{className:"col-4",children:e.jsx("label",{htmlFor:"image-file",children:e.jsx("img",{className:"img-preview img-preview-nft",src:t.image_file||"/imgs/no-image.png"})})}),e.jsxs("div",{className:"col-3",children:[e.jsx("div",{className:"col-10 mt-25",children:e.jsx("p",{className:"class-ticket",children:t==null?void 0:t.nft_name})}),e.jsx("div",{className:"col-10 mt-20",children:e.jsx("p",{className:"class-ticket",children:t.nft_symbol})})]}),e.jsxs("div",{className:"col-3",children:[e.jsx("div",{className:"col-10 mt-25",children:e.jsx("p",{className:"class-ticket",children:t.nft_category})}),e.jsx("div",{className:"col-10 mt-20",children:e.jsx("p",{className:"class-ticket",children:t.nft_amount})})]}),e.jsx("div",{className:"col-2",style:{marginTop:"50px"},children:e.jsx("p",{className:"class-ticket",children:e.jsx("a",{href:`https://suiscan.xyz/testnet/tx/${JSON.parse(t.res).digest}`,children:"TxHash"})})})]});function E(t){const i=new S,a="0x3827b28d5f79b559cf7f9f545cbc99a2653e19d7c99173cec1a9428a478357f5",l="client",r="mint_batch",x=t.nft_name,h=t.nft_amount,j=t.nft_category,g=t.nft_symbol,N=t.image_file??"https://xc6fbqjny4wfkgukliockypoutzhcqwjmlw2gigombpp2ynufaxa.arweave.net/uLxQwS3HLFUailocJWHupPJxQsli7aMgzmBe_WG0KC4",f="0x3b0b0833c020f964c09991796945efa46b4cd66af696df698ae9a41a75383819";return i.moveCall({target:`${a}::${l}::${r}`,arguments:[i.object(f),i.pure(x),i.pure(g),i.pure(N),i.pure(j),i.pure(h)],typeArguments:[`${a}::ticket_collection::NFTTicket`]}),i}function B({nftData:t,_setMinted:i}){const a=k(),[l,r]=y.useState([]),x=$("#mnemonic_client").val(),h=$("#collection_id").val(),[j,g]=y.useState(!1);console.log("------",l);async function N(f){if(f.preventDefault(),!!a.connected){g(!0);for(let s=0;s<t.length;s++){const n=E(t[s]);try{const c=await a.signAndExecuteTransactionBlock({transactionBlock:n,requestType:"WaitForLocalExecution"});alert("Congrats! your nft is minted!"),console.log("nft minted successfully!",c);const p=I.deriveKeypair(x),d=new M({url:R("testnet")});let m=p.getPublicKey().toSuiAddress();const u=await d.getOwnedObjects({owner:m,options:{showType:!0,showDisplay:!0,showContent:!0}}),v=((u==null?void 0:u.data)||[]).filter(o=>o.data.objectId==h).map(o=>o.data.objectId),b=(await d.multiGetObjects({ids:v,options:{showContent:!0,showDisplay:!0,showType:!0}})).filter(o=>o.data).map(o=>({objectId:o.data.objectId,data:o.data.content.fields})).map(o=>o.data.tickets);console.log("tickets:",b);for(let o=0;o<Number(t[s].nft_amount);o++)r(_=>[..._,{...t[s],res:JSON.stringify(c),tickets:JSON.stringify(b)}]);console.log(l),i({...t[s],res:JSON.stringify(c)})}catch(c){alert("Oops, nft minting failed"),console.error("nft mint failed",c)}}g(!1),document.getElementById("append-nft-ticket").innerHTML=""}}return e.jsxs("div",{className:"App",children:[e.jsx(T,{}),e.jsx("section",{style:{marginTop:"15px",textAlign:"right"},children:a.status==="connected"&&e.jsx(e.Fragment,{children:e.jsx("button",{className:"btn btn-primary",onClick:N,children:" Mint Your NFT !"})})}),j&&e.jsx("div",{className:"loading"}),l.map((f,s)=>e.jsx(A,{nftData:f},s))]})}function J(){const[t,i]=y.useState([]),[a,l]=y.useState([{nft_id:0,nft_name:"",nft_symbol:"",image_file:"",nft_category:"Standard",nft_amount:1}]),[r,x]=y.useState([0]),h=(s,n)=>{const{name:c,value:p}=s.target,d=[...a];d[n]&&(d[n][c]=p,l(d)),console.log("nftData:",a)},j=()=>{x([...r,r.length]),l([...a,{nft_id:r.length,nft_name:"",nft_symbol:"",image_file:"",nft_category:"Standard",nft_amount:"1"}])},g=s=>{console.log("index:"+typeof s),x(r.filter((n,c)=>n!==s)),l(a.filter((n,c)=>n.nft_id!==s))},N=async(s,n)=>{let c=s.target.files[0];if(c){let p=new FileReader;p.onloadend=()=>{const m=[...a];m[n]&&(m[n].image_file=p.result,l(m))},p.readAsDataURL(c);let d=new FormData;d.append("file",c,"file-image-nft");try{const m=await F.post("/upload-image-nft",d,{headers:{accept:"application/json","Accept-Language":"en-US,en;q=0.8","Content-Type":`multipart/form-data; boundary=${d._boundary}`}}),u=[...a];u[n]&&(u[n].image_file=m.data.path,l(u))}catch(m){console.error("Error uploading file: ",m)}}},f=(s,n)=>{i([...t,{...s}])};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx("h5",{children:"NFT Ticket"})}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-6"}),e.jsx("div",{className:"col-6",children:e.jsx("p",{children:"Generated NFT Ticket"})})]}),e.jsxs("div",{className:"row",style:{height:"auto",minHeight:"400px"},children:[e.jsx("div",{className:"col-6 append-nft-ticket",id:"append-nft-ticket",style:{borderLeft:"1px",borderRight:"1px solid"},children:r.map((s,n)=>e.jsx(L,{itemKey:s,onDelete:()=>g(s),onInputChange:c=>h(c,n),onFileChange:c=>N(c,n),nftData:a[n],id:`nft-item-${s}`},s))}),e.jsx("div",{className:"col-6 append-nft-detail",id:"append-nft-detail",children:t.map((s,n)=>e.jsx(O,{nftData:s},s))})]}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-6 d-flex flex-row-reverse",style:{borderLeft:"1px",borderRight:"1px solid"},children:e.jsx("div",{className:"p-2",children:e.jsxs("button",{id:"btnAddItemNftReact",type:"button",className:"btn btn-success btn-rounded waves-effect waves-light mb-2 me-2",onClick:j,children:[e.jsx("i",{className:"mdi mdi-plus me-1"})," Add More"]})})})}),e.jsx("div",{className:"row",children:e.jsx("div",{className:"col-6 d-flex flex-row-reverse",style:{borderLeft:"1px",borderRight:"1px solid"},children:e.jsx("div",{className:"p-2",children:e.jsx(C,{children:e.jsx(B,{nftData:a,_setMinted:f})})})})})]})}w.createRoot(document.getElementById("nft_get")).render(e.jsx(J,{}));
