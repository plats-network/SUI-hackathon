import{n as H}from"./nacl-fast-855db264.js";import{b as x,e as Q,a as N,t as kt,c as Bt}from"./legacy-registry-4fcefa09.js";import{b as O}from"./blake2b-0b963f07.js";import{n as ot,S as ct,s as q}from"./TransactionBlock-3fb0dd4a.js";import{k as Ht,l as at,h as ht}from"./_md-5eb5ac83.js";import{s as ft}from"./sha512-d6693c92.js";var D={};Object.defineProperty(D,"__esModule",{value:!0});D.bech32m=J=D.bech32=void 0;const W="qpzry9x8gf2tvdw0s3jn54khce6mua7l",lt={};for(let e=0;e<W.length;e++){const t=W.charAt(e);lt[t]=e}function I(e){const t=e>>25;return(e&33554431)<<5^-(t>>0&1)&996825010^-(t>>1&1)&642813549^-(t>>2&1)&513874426^-(t>>3&1)&1027748829^-(t>>4&1)&705979059}function nt(e){let t=1;for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);if(r<33||r>126)return"Invalid prefix ("+e+")";t=I(t)^r>>5}t=I(t);for(let n=0;n<e.length;++n){const r=e.charCodeAt(n);t=I(t)^r&31}return t}function tt(e,t,n,r){let s=0,o=0;const i=(1<<n)-1,c=[];for(let a=0;a<e.length;++a)for(s=s<<t|e[a],o+=t;o>=n;)o-=n,c.push(s>>o&i);if(r)o>0&&c.push(s<<n-o&i);else{if(o>=t)return"Excess padding";if(s<<n-o&i)return"Non-zero padding"}return c}function It(e){return tt(e,8,5,!0)}function Ut(e){const t=tt(e,5,8,!1);if(Array.isArray(t))return t}function vt(e){const t=tt(e,5,8,!1);if(Array.isArray(t))return t;throw new Error(t)}function dt(e){let t;e==="bech32"?t=1:t=734539939;function n(i,c,a){if(a=a||90,i.length+7+c.length>a)throw new TypeError("Exceeds length limit");i=i.toLowerCase();let d=nt(i);if(typeof d=="string")throw new Error(d);let u=i+"1";for(let h=0;h<c.length;++h){const l=c[h];if(l>>5)throw new Error("Non 5-bit word");d=I(d)^l,u+=W.charAt(l)}for(let h=0;h<6;++h)d=I(d);d^=t;for(let h=0;h<6;++h){const l=d>>(5-h)*5&31;u+=W.charAt(l)}return u}function r(i,c){if(c=c||90,i.length<8)return i+" too short";if(i.length>c)return"Exceeds length limit";const a=i.toLowerCase(),d=i.toUpperCase();if(i!==a&&i!==d)return"Mixed-case string "+i;i=a;const u=i.lastIndexOf("1");if(u===-1)return"No separator character for "+i;if(u===0)return"Missing prefix for "+i;const h=i.slice(0,u),l=i.slice(u+1);if(l.length<6)return"Data too short";let b=nt(h);if(typeof b=="string")return b;const y=[];for(let p=0;p<l.length;++p){const w=l.charAt(p),S=lt[w];if(S===void 0)return"Unknown character "+w;b=I(b)^S,!(p+6>=l.length)&&y.push(S)}return b!==t?"Invalid checksum for "+i:{prefix:h,words:y}}function s(i,c){const a=r(i,c);if(typeof a=="object")return a}function o(i,c){const a=r(i,c);if(typeof a=="object")return a;throw new Error(a)}return{decodeUnsafe:s,decode:o,encode:n,toWords:It,fromWordsUnsafe:Ut,fromWords:vt}}var J=D.bech32=dt("bech32");D.bech32m=dt("bech32m");var C=(e=>(e[e.TransactionData=0]="TransactionData",e[e.TransactionEffects=1]="TransactionEffects",e[e.CheckpointSummary=2]="CheckpointSummary",e[e.PersonalMessage=3]="PersonalMessage",e))(C||{});function _t(e){return[e,0,0]}function ut(e,t){const n=_t(e),r=new Uint8Array(n.length+t.length);return r.set(n),r.set(t,n.length),r}const G={ED25519:0,Secp256k1:1,Secp256r1:2,MultiSig:3,ZkLogin:5},Dt={ED25519:32,Secp256k1:33,Secp256r1:33},Ct={0:"ED25519",1:"Secp256k1",2:"Secp256r1",3:"MultiSig",5:"ZkLogin"};function Kt(e){for(let t=0;t<e.length;t++)if(e[t]!==0)return t;return-1}function Tt(e,t){const n=e.toString(16);return Ht(n.padStart(t*2,"0").slice(-t*2))}function Pt(e,t){const n=Tt(e,t),r=Kt(n);return r===-1?new Uint8Array([0]):n.slice(r)}function Rt(e,t){const n=Pt(e,32);t==="accounts.google.com"&&(t="https://accounts.google.com");const r=new TextEncoder().encode(t),s=new Uint8Array(2+n.length+r.length);return s.set([G.ZkLogin]),s.set([r.length],1),s.set(r,2),s.set(n,2+r.length),ot(at(O(s,{dkLen:32})).slice(0,ct*2))}function Ft(e){if(e.length!==1)throw new Error("Invalid base64Url character: "+e);const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".indexOf(e);if(n===-1)throw new Error("Invalid base64Url character: "+e);const r=n.toString(2).padStart(6,"0");return Array.from(r).map(Number)}function Mt(e){let t=[];for(let n=0;n<e.length;n++){const r=e.charAt(n),s=Ft(r);t=t.concat(s)}return t}function Nt(e,t){if(e.length<2)throw new Error(`Input (s = ${e}) is not tightly packed because s.length < 2`);let n=Mt(e);const r=t%4;if(r!==0)if(r===1)n=n.slice(2);else if(r===2)n=n.slice(4);else throw new Error(`Input (s = ${e}) is not tightly packed because i%4 = 3 (i = ${t}))`);const s=(t+e.length-1)%4;if(s!==3)if(s===2)n=n.slice(0,n.length-2);else if(s===1)n=n.slice(0,n.length-4);else throw new Error(`Input (s = ${e}) is not tightly packed because (i + s.length - 1)%4 = 0 (i = ${t}))`);if(n.length%8!==0)throw new Error("We should never reach here...");const o=new Uint8Array(Math.floor(n.length/8));let i=0;for(let c=0;c<n.length;c+=8){const a=n.slice(c,c+8),d=parseInt(a.join(""),2);o[i++]=d}return new TextDecoder().decode(o)}function Ot(e){if(!(e.slice(-1)==="}"||e.slice(-1)===","))throw new Error("Invalid claim");const t=JSON.parse("{"+e.slice(0,-1)+"}");if(Object.keys(t).length!==1)throw new Error("Invalid claim");const n=Object.keys(t)[0];return[n,t[n]]}function Wt(e,t){const n=Nt(e.value,e.indexMod4),[r,s]=Ot(n);if(r!==t)throw new Error(`Invalid field name: found ${r} expected ${t}`);return s}const $t=x.struct("ZkLoginSignature",{inputs:x.struct("ZkLoginSignatureInputs",{proofPoints:x.struct("ZkLoginSignatureInputsProofPoints",{a:x.vector(x.string()),b:x.vector(x.vector(x.string())),c:x.vector(x.string())}),issBase64Details:x.struct("ZkLoginSignatureInputsClaim",{value:x.string(),indexMod4:x.u8()}),headerBase64:x.string(),addressSeed:x.string()}),maxEpoch:x.u64(),userSignature:x.vector(x.u8())});function Gt(e){return $t.parse(typeof e=="string"?Q(e):e)}function jt({signature:e,signatureScheme:t,publicKey:n}){if(!n)throw new Error("`publicKey` is required");const r=n.toRawBytes(),s=new Uint8Array(1+e.length+r.length);return s.set([G[t]]),s.set(e,1),s.set(r,1+e.length),N(s)}function Zt(e){const t=Q(e),n=Ct[t[0]];switch(n){case"MultiSig":const r=q.MultiSig.parse(t.slice(1));return{serializedSignature:e,signatureScheme:n,multisig:r,bytes:t};case"ZkLogin":const s=t.slice(1),{inputs:o,maxEpoch:i,userSignature:c}=Gt(s),{issBase64Details:a,addressSeed:d}=o,u=Wt(a,"iss"),h=Rt(BigInt(d),u);return{serializedSignature:e,signatureScheme:n,zkLogin:{inputs:o,maxEpoch:i,userSignature:c,iss:u,address:h,addressSeed:BigInt(d)},signature:t};case"ED25519":case"Secp256k1":case"Secp256r1":const l=Dt[n],b=t.slice(1,t.length-l),y=t.slice(1+b.length);return{serializedSignature:e,signatureScheme:n,signature:b,publicKey:y,bytes:t};default:throw new Error("Unsupported signature scheme")}}const F=32,Vt="suiprivkey";class zt{async signWithIntent(t,n){const r=ut(n,t),s=O(r,{dkLen:32});return{signature:jt({signature:await this.sign(s),signatureScheme:this.getKeyScheme(),publicKey:this.getPublicKey()}),bytes:N(t)}}async signTransactionBlock(t){return this.signWithIntent(t,C.TransactionData)}async signPersonalMessage(t){return this.signWithIntent(x.vector(x.u8()).serialize(t).toBytes(),C.PersonalMessage)}toSuiAddress(){return this.getPublicKey().toSuiAddress()}}class qt extends zt{export(){return{schema:this.getKeyScheme(),privateKey:this.getSecretKey()}}}function Jt(e,t){if(e.length!==F)throw new Error("Invalid bytes length");const n=G[t],r=new Uint8Array(e.length+1);return r.set([n]),r.set(e,1),J.encode(Vt,J.toWords(r))}function _(e){if(!Number.isSafeInteger(e)||e<0)throw new Error(`Wrong positive integer: ${e}`)}function Xt(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function gt(e,...t){if(!Xt(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function bt(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");_(e.outputLen),_(e.blockLen)}function $(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function Yt(e,t){gt(e);const n=t.outputLen;if(e.length<n)throw new Error(`digestInto() expects output buffer of length at least ${n}`)}/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */function Qt(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}const M=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),te=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!te)throw new Error("Non little-endian hardware is not supported");function ee(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function K(e){if(typeof e=="string"&&(e=ee(e)),!Qt(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}class yt{clone(){return this._cloneInto()}}const ne={}.toString;function re(e,t){if(t!==void 0&&ne.call(t)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(e,t)}function se(e){const t=r=>e().update(K(r)).digest(),n=e();return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=()=>e(),t}class pt extends yt{constructor(t,n){super(),this.finished=!1,this.destroyed=!1,bt(t);const r=K(n);if(this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const s=this.blockLen,o=new Uint8Array(s);o.set(r.length>s?t.create().update(r).digest():r);for(let i=0;i<o.length;i++)o[i]^=54;this.iHash.update(o),this.oHash=t.create();for(let i=0;i<o.length;i++)o[i]^=106;this.oHash.update(o),o.fill(0)}update(t){return $(this),this.iHash.update(t),this}digestInto(t){$(this),gt(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));const{oHash:n,iHash:r,finished:s,destroyed:o,blockLen:i,outputLen:c}=this;return t=t,t.finished=s,t.destroyed=o,t.blockLen=i,t.outputLen=c,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const xt=(e,t,n)=>new pt(e,t).update(n).digest();xt.create=(e,t)=>new pt(e,t);function ie(e,t,n,r){bt(e);const s=re({dkLen:32,asyncTick:10},r),{c:o,dkLen:i,asyncTick:c}=s;if(_(o),_(i),_(c),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");const a=K(t),d=K(n),u=new Uint8Array(i),h=xt.create(e,a),l=h._cloneInto().update(d);return{c:o,dkLen:i,asyncTick:c,DK:u,PRF:h,PRFSalt:l}}function oe(e,t,n,r,s){return e.destroy(),t.destroy(),r&&r.destroy(),s.fill(0),n}function ce(e,t,n,r){const{c:s,dkLen:o,DK:i,PRF:c,PRFSalt:a}=ie(e,t,n,r);let d;const u=new Uint8Array(4),h=M(u),l=new Uint8Array(c.outputLen);for(let b=1,y=0;y<o;b++,y+=c.outputLen){const p=i.subarray(y,y+c.outputLen);h.setInt32(0,b,!1),(d=a._cloneInto(d)).update(u).digestInto(l),p.set(l.subarray(0,p.length));for(let w=1;w<s;w++){c._cloneInto(d).update(l).digestInto(l);for(let S=0;S<p.length;S++)p[S]^=l[S]}}return oe(c,a,i,d,l)}function ae(e,t,n,r){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,n,r);const s=BigInt(32),o=BigInt(4294967295),i=Number(n>>s&o),c=Number(n&o),a=r?4:0,d=r?0:4;e.setUint32(t+a,i,r),e.setUint32(t+d,c,r)}class he extends yt{constructor(t,n,r,s){super(),this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=s,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=M(this.buffer)}update(t){$(this);const{view:n,buffer:r,blockLen:s}=this;t=K(t);const o=t.length;for(let i=0;i<o;){const c=Math.min(s-this.pos,o-i);if(c===s){const a=M(t);for(;s<=o-i;i+=s)this.process(a,i);continue}r.set(t.subarray(i,i+c),this.pos),this.pos+=c,i+=c,this.pos===s&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){$(this),Yt(t,this),this.finished=!0;const{buffer:n,view:r,blockLen:s,isLE:o}=this;let{pos:i}=this;n[i++]=128,this.buffer.subarray(i).fill(0),this.padOffset>s-i&&(this.process(r,0),i=0);for(let h=i;h<s;h++)n[h]=0;ae(r,s-8,BigInt(this.length*8),o),this.process(r,0);const c=M(t),a=this.outputLen;if(a%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const d=a/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)c.setUint32(4*h,u[h],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:n,buffer:r,length:s,finished:o,destroyed:i,pos:c}=this;return t.length=s,t.pos=c,t.finished=o,t.destroyed=i,s%n&&t.buffer.set(r),t}}const R=BigInt(2**32-1),X=BigInt(32);function wt(e,t=!1){return t?{h:Number(e&R),l:Number(e>>X&R)}:{h:Number(e>>X&R)|0,l:Number(e&R)|0}}function fe(e,t=!1){let n=new Uint32Array(e.length),r=new Uint32Array(e.length);for(let s=0;s<e.length;s++){const{h:o,l:i}=wt(e[s],t);[n[s],r[s]]=[o,i]}return[n,r]}const le=(e,t)=>BigInt(e>>>0)<<X|BigInt(t>>>0),de=(e,t,n)=>e>>>n,ue=(e,t,n)=>e<<32-n|t>>>n,ge=(e,t,n)=>e>>>n|t<<32-n,be=(e,t,n)=>e<<32-n|t>>>n,ye=(e,t,n)=>e<<64-n|t>>>n-32,pe=(e,t,n)=>e>>>n-32|t<<64-n,xe=(e,t)=>t,we=(e,t)=>e,Se=(e,t,n)=>e<<n|t>>>32-n,Ee=(e,t,n)=>t<<n|e>>>32-n,me=(e,t,n)=>t<<n-32|e>>>64-n,Ae=(e,t,n)=>e<<n-32|t>>>64-n;function Le(e,t,n,r){const s=(t>>>0)+(r>>>0);return{h:e+n+(s/2**32|0)|0,l:s|0}}const ke=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),Be=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,He=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),Ie=(e,t,n,r,s)=>t+n+r+s+(e/2**32|0)|0,Ue=(e,t,n,r,s)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(s>>>0),ve=(e,t,n,r,s,o)=>t+n+r+s+o+(e/2**32|0)|0,_e={fromBig:wt,split:fe,toBig:le,shrSH:de,shrSL:ue,rotrSH:ge,rotrSL:be,rotrBH:ye,rotrBL:pe,rotr32H:xe,rotr32L:we,rotlSH:Se,rotlSL:Ee,rotlBH:me,rotlBL:Ae,add:Le,add3L:ke,add3H:Be,add4L:He,add4H:Ie,add5H:ve,add5L:Ue},f=_e,[De,Ce]=(()=>f.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))))(),k=new Uint32Array(80),B=new Uint32Array(80);class Ke extends he{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:n,Bh:r,Bl:s,Ch:o,Cl:i,Dh:c,Dl:a,Eh:d,El:u,Fh:h,Fl:l,Gh:b,Gl:y,Hh:p,Hl:w}=this;return[t,n,r,s,o,i,c,a,d,u,h,l,b,y,p,w]}set(t,n,r,s,o,i,c,a,d,u,h,l,b,y,p,w){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=s|0,this.Ch=o|0,this.Cl=i|0,this.Dh=c|0,this.Dl=a|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=l|0,this.Gh=b|0,this.Gl=y|0,this.Hh=p|0,this.Hl=w|0}process(t,n){for(let g=0;g<16;g++,n+=4)k[g]=t.getUint32(n),B[g]=t.getUint32(n+=4);for(let g=16;g<80;g++){const A=k[g-15]|0,L=B[g-15]|0,j=f.rotrSH(A,L,1)^f.rotrSH(A,L,8)^f.shrSH(A,L,7),Z=f.rotrSL(A,L,1)^f.rotrSL(A,L,8)^f.shrSL(A,L,7),E=k[g-2]|0,m=B[g-2]|0,T=f.rotrSH(E,m,19)^f.rotrBH(E,m,61)^f.shrSH(E,m,6),V=f.rotrSL(E,m,19)^f.rotrBL(E,m,61)^f.shrSL(E,m,6),P=f.add4L(Z,V,B[g-7],B[g-16]),z=f.add4H(P,j,T,k[g-7],k[g-16]);k[g]=z|0,B[g]=P|0}let{Ah:r,Al:s,Bh:o,Bl:i,Ch:c,Cl:a,Dh:d,Dl:u,Eh:h,El:l,Fh:b,Fl:y,Gh:p,Gl:w,Hh:S,Hl:U}=this;for(let g=0;g<80;g++){const A=f.rotrSH(h,l,14)^f.rotrSH(h,l,18)^f.rotrBH(h,l,41),L=f.rotrSL(h,l,14)^f.rotrSL(h,l,18)^f.rotrBL(h,l,41),j=h&b^~h&p,Z=l&y^~l&w,E=f.add5L(U,L,Z,Ce[g],B[g]),m=f.add5H(E,S,A,j,De[g],k[g]),T=E|0,V=f.rotrSH(r,s,28)^f.rotrBH(r,s,34)^f.rotrBH(r,s,39),P=f.rotrSL(r,s,28)^f.rotrBL(r,s,34)^f.rotrBL(r,s,39),z=r&o^r&c^o&c,Lt=s&i^s&a^i&a;S=p|0,U=w|0,p=b|0,w=y|0,b=h|0,y=l|0,{h,l}=f.add(d|0,u|0,m|0,T|0),d=c|0,u=a|0,c=o|0,a=i|0,o=r|0,i=s|0;const et=f.add3L(T,P,Lt);r=f.add3H(et,m,V,z),s=et|0}({h:r,l:s}=f.add(this.Ah|0,this.Al|0,r|0,s|0)),{h:o,l:i}=f.add(this.Bh|0,this.Bl|0,o|0,i|0),{h:c,l:a}=f.add(this.Ch|0,this.Cl|0,c|0,a|0),{h:d,l:u}=f.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l}=f.add(this.Eh|0,this.El|0,h|0,l|0),{h:b,l:y}=f.add(this.Fh|0,this.Fl|0,b|0,y|0),{h:p,l:w}=f.add(this.Gh|0,this.Gl|0,p|0,w|0),{h:S,l:U}=f.add(this.Hh|0,this.Hl|0,S|0,U|0),this.set(r,s,o,i,c,a,d,u,h,l,b,y,p,w,S,U)}roundClean(){k.fill(0),B.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const Te=se(()=>new Ke);/*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) */function St(e){if(typeof e!="string")throw new TypeError(`Invalid mnemonic type: ${typeof e}`);return e.normalize("NFKD")}function Pe(e){const t=St(e),n=t.split(" ");if(![12,15,18,21,24].includes(n.length))throw new Error("Invalid mnemonic");return{nfkd:t,words:n}}const Re=e=>St(`mnemonic${e}`);function Fe(e,t=""){return ce(Te,Pe(e).nfkd,Re(t),{c:2048,dkLen:64})}function rt(e){return!!new RegExp("^m\\/44'\\/784'\\/[0-9]+'\\/[0-9]+'\\/[0-9]+'+$").test(e)}function Me(e){return Fe(e,"")}function Ne(e){return kt(Me(e))}const Oe="ed25519 seed",We=2147483648,$e=new RegExp("^m(\\/[0-9]+')+$"),Et=e=>e.replace("'",""),Ge=e=>{const n=ht.create(ft,Oe).update(Bt(e)).digest(),r=n.slice(0,32),s=n.slice(32);return{key:r,chainCode:s}},je=({key:e,chainCode:t},n)=>{const r=new ArrayBuffer(4);new DataView(r).setUint32(0,n);const o=new Uint8Array(1+e.length+r.byteLength);o.set(new Uint8Array(1).fill(0)),o.set(e,1),o.set(new Uint8Array(r,0,r.byteLength),e.length+1);const i=ht.create(ft,t).update(o).digest(),c=i.slice(0,32),a=i.slice(32);return{key:c,chainCode:a}},Ze=e=>$e.test(e)?!e.split("/").slice(1).map(Et).some(isNaN):!1,st=(e,t,n=We)=>{if(!Ze(e))throw new Error("Invalid derivation path");const{key:r,chainCode:s}=Ge(t);return e.split("/").slice(1).map(Et).map(i=>parseInt(i,10)).reduce((i,c)=>je(i,c+n),{key:r,chainCode:s})};function mt(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}class Ve{equals(t){return mt(this.toRawBytes(),t.toRawBytes())}toBase64(){return N(this.toRawBytes())}toString(){throw new Error("`toString` is not implemented on public keys. Use `toBase64()` or `toRawBytes()` instead.")}toSuiPublicKey(){const t=this.toSuiBytes();return N(t)}verifyWithIntent(t,n,r){const s=ut(r,t),o=O(s,{dkLen:32});return this.verify(o,n)}verifyPersonalMessage(t,n){return this.verifyWithIntent(q.vector(q.u8()).serialize(t).toBytes(),n,C.PersonalMessage)}verifyTransactionBlock(t,n){return this.verifyWithIntent(t,n,C.TransactionData)}toSuiBytes(){const t=this.toRawBytes(),n=new Uint8Array(t.length+1);return n.set([this.flag()]),n.set(t,1),n}toSuiAddress(){return ot(at(O(this.toSuiBytes(),{dkLen:32})).slice(0,ct*2))}}const Y=32;class At extends Ve{constructor(t){if(super(),typeof t=="string"?this.data=Q(t):t instanceof Uint8Array?this.data=t:this.data=Uint8Array.from(t),this.data.length!==Y)throw new Error(`Invalid public key input. Expected ${Y} bytes, got ${this.data.length}`)}equals(t){return super.equals(t)}toRawBytes(){return this.data}flag(){return G.ED25519}async verify(t,n){let r;if(typeof n=="string"){const s=Zt(n);if(s.signatureScheme!=="ED25519")throw new Error("Invalid signature scheme");if(!mt(this.toRawBytes(),s.publicKey))throw new Error("Signature does not match public key");r=s.signature}else r=n;return H.sign.detached.verify(t,r,this.toRawBytes())}}At.SIZE=Y;const it="m/44'/784'/0'/0'/0'";class v extends qt{constructor(t){super(),t?this.keypair=t:this.keypair=H.sign.keyPair()}getKeyScheme(){return"ED25519"}static generate(){return new v(H.sign.keyPair())}static fromSecretKey(t,n){const r=t.length;if(r!==F)throw new Error(`Wrong secretKey size. Expected ${F} bytes, got ${r}.`);const s=H.sign.keyPair.fromSeed(t);if(!n||!n.skipValidation){const i=new TextEncoder().encode("sui validation"),c=H.sign.detached(i,s.secretKey);if(!H.sign.detached.verify(i,c,s.publicKey))throw new Error("provided secretKey is invalid")}return new v(s)}getPublicKey(){return new At(this.keypair.publicKey)}getSecretKey(){return Jt(this.keypair.secretKey.slice(0,F),this.getKeyScheme())}async sign(t){return this.signData(t)}signData(t){return H.sign.detached(t,this.keypair.secretKey)}static deriveKeypair(t,n){if(n==null&&(n=it),!rt(n))throw new Error("Invalid derivation path");const{key:r}=st(n,Ne(t));return v.fromSecretKey(r)}static deriveKeypairFromSeed(t,n){if(n==null&&(n=it),!rt(n))throw new Error("Invalid derivation path");const{key:r}=st(n,t);return v.fromSecretKey(r)}}export{v as E};
